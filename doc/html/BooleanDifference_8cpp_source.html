<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>leica_point_cloud_processing: BooleanDifference.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BooleanDifference.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="BooleanDifference_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="BooleanDifference_8h.html">BooleanDifference.h</a>&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="classBooleanDifference.html#a7e41983354236a0017e70c656495abbb">    3</a></span>&#160;<a class="code" href="classBooleanDifference.html#a7e41983354236a0017e70c656495abbb">BooleanDifference::BooleanDifference</a>(PointCloudRGB::Ptr cloud)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;      : _diff_indices(new <a class="code" href="classBooleanDifference.html#a55622e45311acbd02b79fdfaf8b5a711">IndicesVector</a>), _result_cloud(new <a class="code" href="classBooleanDifference.html#a50f9ccfcf86f020f2c80a382423b3c0e">PointCloudRGB</a>)</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;{</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  <a class="code" href="classBooleanDifference.html#a4d0d855e0a7fca52f58c15a226e3263d">_cloud</a> = cloud;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <a class="code" href="classBooleanDifference.html#aee16f8325db931b4d9ac878f9c18a7d4">computeResolution</a>(cloud);</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <a class="code" href="classBooleanDifference.html#ab0d72db71794d4ba7cc58d2c9ed894cd">substract_error</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="classBooleanDifference.html#a43f8e592bfb163470161733b0cec1fa9">   11</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBooleanDifference.html#a43f8e592bfb163470161733b0cec1fa9">BooleanDifference::substract</a>(PointCloudRGB::Ptr cloud_to_substract)</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <a class="code" href="classBooleanDifference.html#ac508e3f3a101527d5599789f7f3a27da">setOctreeAndGetIndices</a>(cloud_to_substract);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordtype">int</span> res = <a class="code" href="classBooleanDifference.html#addb40ab2bd4674edbedee6a54206b128">computeResultCloud</a>();</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">if</span> (res!=0)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="classBooleanDifference.html#ab0d72db71794d4ba7cc58d2c9ed894cd">substract_error</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;}</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classBooleanDifference.html#afd8aec8c4a57f6398b6e42aad3f63854">   20</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classBooleanDifference.html#afd8aec8c4a57f6398b6e42aad3f63854">BooleanDifference::getVoxelResolution</a>()</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classBooleanDifference.html#ab5dfcc83122516dea4f36ac17037b068">_voxel_resolution</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="classBooleanDifference.html#ac9322c284f4ab47ccea2ce1d0d73d1d3">   26</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBooleanDifference.html#ac9322c284f4ab47ccea2ce1d0d73d1d3">BooleanDifference::getResultCloud</a>(PointCloudRGB::Ptr result_cloud)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  pcl::copyPointCloud(*<a class="code" href="classBooleanDifference.html#afff792363d855b69219e38a38782541d">_result_cloud</a>, *result_cloud);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classBooleanDifference.html#aee16f8325db931b4d9ac878f9c18a7d4">   32</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBooleanDifference.html#aee16f8325db931b4d9ac878f9c18a7d4">BooleanDifference::computeResolution</a>(PointCloudRGB::Ptr cloud)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">double</span> res = <a class="code" href="classUtils.html#a3eb90745a887172f3705ddc030b82ab3">Utils::computeCloudResolution</a>(cloud);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="classBooleanDifference.html#ab5dfcc83122516dea4f36ac17037b068">_voxel_resolution</a> = res * 3; <span class="comment">// 3 times higher to cover more than two neighbors</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  ROS_INFO(<span class="stringliteral">&quot;Voxelize octree with resolution: %f&quot;</span>, <a class="code" href="classBooleanDifference.html#ab5dfcc83122516dea4f36ac17037b068">_voxel_resolution</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classBooleanDifference.html#ac508e3f3a101527d5599789f7f3a27da">   40</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBooleanDifference.html#ac508e3f3a101527d5599789f7f3a27da">BooleanDifference::setOctreeAndGetIndices</a>(PointCloudRGB::Ptr cloud_to_substract)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  pcl::octree::OctreePointCloudChangeDetector&lt;pcl::PointXYZRGB&gt; octree(<a class="code" href="classBooleanDifference.html#ab5dfcc83122516dea4f36ac17037b068">_voxel_resolution</a>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  octree.setInputCloud(cloud_to_substract);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  octree.addPointsFromInputCloud();</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// Switch octree buffers: This resets octree but keeps previous tree structure in memory.</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  octree.switchBuffers();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  octree.setInputCloud(<a class="code" href="classBooleanDifference.html#a4d0d855e0a7fca52f58c15a226e3263d">_cloud</a>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  octree.addPointsFromInputCloud();</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  ROS_INFO(<span class="stringliteral">&quot;Extracting differences&quot;</span>);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  octree.getPointIndicesFromNewVoxels(*<a class="code" href="classBooleanDifference.html#a72c2d5b1a5adf6800c350b16eb8480ea">_diff_indices</a>);<span class="comment">// Diferentiated points</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classBooleanDifference.html#addb40ab2bd4674edbedee6a54206b128">   57</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classBooleanDifference.html#addb40ab2bd4674edbedee6a54206b128">BooleanDifference::computeResultCloud</a>()</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  PointCloudRGB::Ptr result_cloud(<span class="keyword">new</span> <a class="code" href="classBooleanDifference.html#a50f9ccfcf86f020f2c80a382423b3c0e">PointCloudRGB</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classUtils.html#af409af78969c505d1c18f3f223dba53d">Utils::indicesFilter</a>(<a class="code" href="classBooleanDifference.html#a4d0d855e0a7fca52f58c15a226e3263d">_cloud</a>, result_cloud, <a class="code" href="classBooleanDifference.html#a72c2d5b1a5adf6800c350b16eb8480ea">_diff_indices</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">// pcl::ExtractIndices&lt;pcl::PointXYZRGB&gt; extract_indices_filter;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// extract_indices_filter.setInputCloud(_cloud);</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// extract_indices_filter.setIndices(_diff_indices);</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// extract_indices_filter.filter(*result_cloud);</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (result_cloud-&gt;size() &lt;= 0)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    ROS_ERROR(<span class="stringliteral">&quot;No differences found. Try a small resolution&quot;</span>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  pcl::copyPointCloud(*result_cloud, *<a class="code" href="classBooleanDifference.html#afff792363d855b69219e38a38782541d">_result_cloud</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="ttc" id="classBooleanDifference_html_aee16f8325db931b4d9ac878f9c18a7d4"><div class="ttname"><a href="classBooleanDifference.html#aee16f8325db931b4d9ac878f9c18a7d4">BooleanDifference::computeResolution</a></div><div class="ttdeci">void computeResolution(PointCloudRGB::Ptr cloud)</div><div class="ttdoc">Compute cloud resolution and set voxel resolution. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8cpp_source.html#l00032">BooleanDifference.cpp:32</a></div></div>
<div class="ttc" id="classBooleanDifference_html_ac9322c284f4ab47ccea2ce1d0d73d1d3"><div class="ttname"><a href="classBooleanDifference.html#ac9322c284f4ab47ccea2ce1d0d73d1d3">BooleanDifference::getResultCloud</a></div><div class="ttdeci">void getResultCloud(PointCloudRGB::Ptr result_cloud)</div><div class="ttdoc">Get the Result Cloud object obtained from substraction. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8cpp_source.html#l00026">BooleanDifference.cpp:26</a></div></div>
<div class="ttc" id="classBooleanDifference_html_a4d0d855e0a7fca52f58c15a226e3263d"><div class="ttname"><a href="classBooleanDifference.html#a4d0d855e0a7fca52f58c15a226e3263d">BooleanDifference::_cloud</a></div><div class="ttdeci">PointCloudRGB::Ptr _cloud</div><div class="ttdoc">Base cloud. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8h_source.html#l00064">BooleanDifference.h:64</a></div></div>
<div class="ttc" id="classBooleanDifference_html_ab0d72db71794d4ba7cc58d2c9ed894cd"><div class="ttname"><a href="classBooleanDifference.html#ab0d72db71794d4ba7cc58d2c9ed894cd">BooleanDifference::substract_error</a></div><div class="ttdeci">bool substract_error</div><div class="ttdoc">If true, substracting process failed. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8h_source.html#l00033">BooleanDifference.h:33</a></div></div>
<div class="ttc" id="classBooleanDifference_html_a43f8e592bfb163470161733b0cec1fa9"><div class="ttname"><a href="classBooleanDifference.html#a43f8e592bfb163470161733b0cec1fa9">BooleanDifference::substract</a></div><div class="ttdeci">void substract(PointCloudRGB::Ptr cloud_to_substract)</div><div class="ttdoc">Implement substraction between cloud and cloud_to_substract. Store result cloud. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8cpp_source.html#l00011">BooleanDifference.cpp:11</a></div></div>
<div class="ttc" id="classBooleanDifference_html_ab5dfcc83122516dea4f36ac17037b068"><div class="ttname"><a href="classBooleanDifference.html#ab5dfcc83122516dea4f36ac17037b068">BooleanDifference::_voxel_resolution</a></div><div class="ttdeci">double _voxel_resolution</div><div class="ttdoc">The Voxel Resolution to set OcTree. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8h_source.html#l00070">BooleanDifference.h:70</a></div></div>
<div class="ttc" id="classBooleanDifference_html_afff792363d855b69219e38a38782541d"><div class="ttname"><a href="classBooleanDifference.html#afff792363d855b69219e38a38782541d">BooleanDifference::_result_cloud</a></div><div class="ttdeci">PointCloudRGB::Ptr _result_cloud</div><div class="ttdoc">Result cloud from differenciating _cloud and other. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8h_source.html#l00067">BooleanDifference.h:67</a></div></div>
<div class="ttc" id="BooleanDifference_8h_html"><div class="ttname"><a href="BooleanDifference_8h.html">BooleanDifference.h</a></div></div>
<div class="ttc" id="classUtils_html_a3eb90745a887172f3705ddc030b82ab3"><div class="ttname"><a href="classUtils.html#a3eb90745a887172f3705ddc030b82ab3">Utils::computeCloudResolution</a></div><div class="ttdeci">static double computeCloudResolution(PointCloudXYZ::Ptr cloud)</div><div class="ttdoc">Obtain the resolution of the cloud. </div><div class="ttdef"><b>Definition:</b> <a href="Utils_8cpp_source.html#l00085">Utils.cpp:85</a></div></div>
<div class="ttc" id="classUtils_html_af409af78969c505d1c18f3f223dba53d"><div class="ttname"><a href="classUtils.html#af409af78969c505d1c18f3f223dba53d">Utils::indicesFilter</a></div><div class="ttdeci">static void indicesFilter(PointCloudRGB::Ptr cloud_in, PointCloudRGB::Ptr cloud_out, boost::shared_ptr&lt; std::vector&lt; int &gt; &gt; indices)</div><div class="ttdoc">Apply extract indices filter to input cloud with given indices. </div><div class="ttdef"><b>Definition:</b> <a href="Utils_8cpp_source.html#l00153">Utils.cpp:153</a></div></div>
<div class="ttc" id="classBooleanDifference_html_a50f9ccfcf86f020f2c80a382423b3c0e"><div class="ttname"><a href="classBooleanDifference.html#a50f9ccfcf86f020f2c80a382423b3c0e">BooleanDifference::PointCloudRGB</a></div><div class="ttdeci">pcl::PointCloud&lt; pcl::PointXYZRGB &gt; PointCloudRGB</div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8h_source.html#l00016">BooleanDifference.h:16</a></div></div>
<div class="ttc" id="classBooleanDifference_html_a7e41983354236a0017e70c656495abbb"><div class="ttname"><a href="classBooleanDifference.html#a7e41983354236a0017e70c656495abbb">BooleanDifference::BooleanDifference</a></div><div class="ttdeci">BooleanDifference(PointCloudRGB::Ptr cloud)</div><div class="ttdoc">Construct a new Boolean Difference object. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8cpp_source.html#l00003">BooleanDifference.cpp:3</a></div></div>
<div class="ttc" id="classBooleanDifference_html_addb40ab2bd4674edbedee6a54206b128"><div class="ttname"><a href="classBooleanDifference.html#addb40ab2bd4674edbedee6a54206b128">BooleanDifference::computeResultCloud</a></div><div class="ttdeci">int computeResultCloud()</div><div class="ttdoc">Filter cloud with indices obtained. Store result cloud. Returns -1 if error. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8cpp_source.html#l00057">BooleanDifference.cpp:57</a></div></div>
<div class="ttc" id="classBooleanDifference_html_a72c2d5b1a5adf6800c350b16eb8480ea"><div class="ttname"><a href="classBooleanDifference.html#a72c2d5b1a5adf6800c350b16eb8480ea">BooleanDifference::_diff_indices</a></div><div class="ttdeci">IndicesVectorPtr _diff_indices</div><div class="ttdoc">Indices of differences found. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8h_source.html#l00073">BooleanDifference.h:73</a></div></div>
<div class="ttc" id="classBooleanDifference_html_ac508e3f3a101527d5599789f7f3a27da"><div class="ttname"><a href="classBooleanDifference.html#ac508e3f3a101527d5599789f7f3a27da">BooleanDifference::setOctreeAndGetIndices</a></div><div class="ttdeci">void setOctreeAndGetIndices(PointCloudRGB::Ptr cloud_to_substract)</div><div class="ttdoc">Apply boolean difference from Octrees and store indices of differences found. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8cpp_source.html#l00040">BooleanDifference.cpp:40</a></div></div>
<div class="ttc" id="classBooleanDifference_html_afd8aec8c4a57f6398b6e42aad3f63854"><div class="ttname"><a href="classBooleanDifference.html#afd8aec8c4a57f6398b6e42aad3f63854">BooleanDifference::getVoxelResolution</a></div><div class="ttdeci">double getVoxelResolution()</div><div class="ttdoc">Get the Voxel Resolution object. </div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8cpp_source.html#l00020">BooleanDifference.cpp:20</a></div></div>
<div class="ttc" id="classBooleanDifference_html_a55622e45311acbd02b79fdfaf8b5a711"><div class="ttname"><a href="classBooleanDifference.html#a55622e45311acbd02b79fdfaf8b5a711">BooleanDifference::IndicesVector</a></div><div class="ttdeci">std::vector&lt; int &gt; IndicesVector</div><div class="ttdef"><b>Definition:</b> <a href="BooleanDifference_8h_source.html#l00017">BooleanDifference.h:17</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/leica_point_cloud_processing">leica_point_cloud_processing</a><br />
Author(s): Ines Lara Sicilia <imlara@catec.aero></br />
<small>autogenerated on Fri Jul 31 2020 08:28:37</small>
</div>
</body>
</html>
